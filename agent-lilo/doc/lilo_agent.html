<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<body>
<PRE>
<B>Interface specification for lilo.conf agent</B>

Author: dan.meszaros dmeszar@suse.cz
Last update: 2001-06-01 13:00:00

<B>I. What is the lilo.conf agent</B>

It is used to access the /etc/lilo.conf file.


<B>II. Syntax of the lilo.conf file</B>

lilo.conf file (see man 5 lilo.conf) is a configuration file for lilo
(see man 8 lilo). It consists of
    a) comments
    b) options
    c) sections


<B>II.1 Comments</B>

Comment lines may appear anywhere, and begin with the "#" character.
eg: # lilo.conf
# last modified: blah

option=value # some description here


<B>II.2 Options</B>

There are three types of options:
    a) boolean
    b) having a value (string, number)
    c) special
The presence of boolean option indicates, that the option has value <B>TRUE</B>.

<B>eg: </B>
prompt
compact
# the prompt and compact options are set


The options having a value use a form "option=value"
<B>eg: </B>
vga=normal
root=/dev/hda1

The special option is an option having a deeper structure.
<B>eg: </b>change-rules

change-rules
  reset
  type=DOS12
  normal=1
  hidden=0x11
  type=DOS16_small
  normal=4
  hidden=0x14
  type=DOS16_big
  normal=0x06
  hidden=0x16

The global options appear in the beginning of the lilo.conf file,
the sections follow them.


<B>II.3 Sections</B>

Sections start with an identifier of the section and follow with the options
specific for the given section. eg: image=/boot/zImage-1.0.9

# first "image" sections
    image=/tamu/vmlinuz
	label=tamu
	root=/dev/hdb2
        vga=ask

# second "image" sections
    image=/boot/vmlinuz-2.4
    label=2.4

<B>III. Interface for lilo.conf agent</B>


<B>III.1 Reading</B>

Read(.lilo)				rereads the file, thus discards
					changes made using Write(...)
Read(.lilo.comment)			trailing comment
					for lilo.file
Read(.lilo.optname)			returns value of global variable 'optname'
Read(.lilo.optname.comment)		returns contents of comment for option 'optname'
Read(.lilo.image)			returns list of 'image' sections
Read(.lilo.other)			returns list of 'other' sections
Read(.lilo.sections.vmlinuz)		returns list of all options in section 'vmlinuz'
Read(.lilo.sections.vmlinuz.image.comment)  returns comment for image section 'vmlinuz'
Read(.lilo.sections.windows.other.comment)  returns comment for other section 'windows'
Read(.lilo.image.vmlinuz.label)		returns value of option 'label' in the image 
					section 'vmlinuz'
Read(.lilo.sections.vmlinuz.label.comment) returns value of comment for option 'label' 
					in the image section 'vmlinuz'


<B>III.2 Writing</B>

Write(.lilo, nil)			writes the file to disk
Write(.lilo.comment, "# com")		trailing comment for lilo.file
Write(.lilo.optname, value)		writes value of global variable 'optname'
Write(.lilo.optname.comment, "# com")	writes comment for option 'optname'
Write(.lilo.optname, nil)		discards the option 
Write(.lilo.image.label, "label", "vava") if section with name 'vava' didn't exist, 
					it is created and value for 'label' is set
Write(.lilo.sections.vmlinuz, nil)		discards the section 'vmlinuz'
Write(.lilo.sections.vmlinuz.comment, "# com")writes comment for image section 'vmlinuz'
Write(.lilo.sections.vmlinuz.label, value)	sets value of option 'label' in the image section 'vmlinuz'
Write(.lilo.sections.vmlinuz.label.comment, "# com") sets value of comment for option 'label' 
					in the image section 'vmlinuz'


<B>III.3 Dir</B>

Dir(.lilo)				list od all globa variables. if
					there is at least one image/other section, list 
					also contains item 'image'/"other"
Dir(.lilo.sections)			list of image sections
Dir(.lilo.sections.vmlinuz)		list of options in given image


<B>III.4 Execute</B>

Execute(.lilo, params)			tes /sbin/lilo.
since /sbin/lilo is launched while Write(.lilo, nil) this is only
for special purpose.


<B>III.5 Other</b>

Bahaviour of other commands is not defined.


<B>IV.1 Appendix A: global options</B>

Boolean:
    compact .lilo.compact
    fix-table .lilo.fix_table
    ignore-table .lilo.ignore_table
    lba32 .lilo.lba32
    linear .lilo.linear
    lock .lilo.lock
    nowarn .lilo.nowarn
    optional .lilo.optional
    prompt .lilo.prompt
    read-only .lilo.read-only
    restricted .lilo.restricted

String:
    backup .lilo.backup
    boot .lilo.boot
    default .lilo.default
    disktab .lilo.disktab
    force-backup .lilo.force_backup
    install .lilo.install
    map .lilo.map
    menu-title .lilo.menu_title
    menu-scheme .lilo.menu_scheme
    message .lilo.message
    password .lilo.password
    serial .lilo.serial
   
Integer:
    delay .lilo.delay
    timeout .lilo.timeout
    verbose .lilo.verbose

Special:
    change-rules .lilo.change_rules
    disk .lilo.disk


<B>IV.2 Appendix B: image section variables</B>

boolean options:
    read-only .lilo.image.read_only,  section_name
    read-write .lilo.image.read_write,  section_name

string options:
    append .lilo.sections._.append, section_name
    initrd .lilo.sections._.initrd, section_name
    literal .lilo.sections._.literal, section_name
    amdisk .lilo.sections._.ramdisk, section_name
    root .lilo.sections._.root, section_name
    vga .lilo.sections._.vga, section_name


<B>IV.3 Appendix B: other section variables</B>

boolean options:
    unsafe .lilo.sections._.unsafe

string options:
    loader .lilo.sections._.loader
    table .lilo.sections._.table

special options:
    change .lilo.sections._.change
    map-drive .lilo.sections._.map_drive


<B>IV.4 Appendix B: common image and other section variables</B>

boolean options:
    lock .lilo.sections.lock
    optional .lilo.sections._.optional
    restricted .lilo.sections._.restricted

string options:
    label .lilo.sections._.label
    alias .lilo.sections._.alias
    password .lilo.sections._.password

</BODY></HTML>
<B>V. Notes</b>
[x] - The written file should use indentation
<br>[ ]- The representation of the file must have a time-stamp of the original
file
<br>and each option and section must have a "dirty" flag---a flag which
says if
<br>it was changed by the agent interface.
<br>If the file changes on the disk, the lilo.conf agent must try to re-read
<br>the data which has changed on the disk but was not changed using the
<br>agent interface (to keep the newest poassible version).
<br>The conflict must be logged.
<br>[x]- The order of the options and sections must be the same as it was
in the
<br>original file.
<p>Example
<br>-------
<br>This file (from man 5 lilo.conf)
<p># lilo.conf
<br>#
<br># global options:
<br>boot=/dev/hda
<br>prompt
<br>timeout=150
<br>lba32
<br>compact
<br>vga=normal
<br>root=/dev/hda1
<br>read-only
<br>menu-title=" John's Computer "
<br>#
<br># bootable kernel images:
<br>image=/boot/zImage-1.5.99
<br>label=try
<br>image=/boot/zImage-1.0.9
<br>label=1.0.9
<br>image=/tamu/vmlinuz
<br>label=tamu
<br>root=/dev/hdb2
<br>vga=ask
<br>#
<br># other operating systems:
<br>other=/dev/hda3
<br>label=dos
<br>other=/dev/hdb5
<br>label=os2
<br>loader=/boot/os2_d.b
<br>table=E:
<p>will be written by the following SCR calls:
<p>// The comment for the file
<br>Write(.lilo.comment, "# lilo.conf\n#\n# global options:");
<p>// The global options
<br>// boolean
<br>Write(.lilo.prompt, true);
<br>Write(.lilo.lba32, true);
<br>Write(.lilo.compact, true);
<br>Write(.lilo.read_only, true);
<br>// string
<br>Write(.lilo.boot, "/dev/hda");
<br>Write(.lilo.vga, "normal");
<br>Write(.lilo.root, "/dev/hda1");
<br>Write(.lilo.menu_title, " John's Computer "
<br>// integer
<br>Write(.lilo.timeout, 150);
<p>// The images sections
<br>Write(.lilo.image.label, "try", "/boot/zImage-1.5.99");
<br>Write(.lilo.image.comment, "#\n# bootable kernel images:", "/boot/zImage-1.5.99");
<p>Write(.lilo.image.label, "1.0.9", "/boot/zImage-1.0.9");
<p>Write(.lilo.image.label, "tamu", "/tamu/vmlinuz");
<br>Write(.lilo.image.root, "/dev/hdb2", "/tamu/vmlinuz");
<br>Write(.lilo.image.vga, "ask", "/tamu/vmlinuz");
<p>// Other sections
<br>Write(.lilo.other.label, "dos", "/dev/hda3");
<p>Write(.lilo.other.label, "os2", "/dev/hdb5");
<br>Write(.lilo.other.loader, "/boot/os2_d.b", "/dev/hdb5");
<br>Write(.lilo.other.table, "E:", "/dev/hdb5");
<p>Just for case:
<p>Dir(.lilo)
<br>--> [ "prompt", "lba32", "compact", "read_only", "boot", "vga",
<br>"root", "menu_title", "timeout", "image", "other"]
<p>Read(.lilo.image) or Dir(.lilo.image)
<br>--> [ "/boot/zImage-1.5.99", "/boot/zImage-1.0.9", "/tamu/vmlinuz"
]
<p>Read(.lilo.image, "/tamu/vmlinuz")
<br>--> [ "label", "root", "vga" ]
<p>Example 2
<br>---------
<p>This
<p>change-rules
<br>reset
<br>type=DOS12
<br>normal=1
<br>hidden=0x11
<br>type=DOS16_small
<br>normal=4
<br>hidden=0x14
<br>type=DOS16_big
<br>normal=0x06
<br>hidden=0x16
<p>can be written using
<p>Write(.lilo.change_rules, [ "reset", "type=DOS12", "normal=1",
<br>"hidden=0x11", "type=DOS16_small", "normal=4",
<br>"hidden=0x14", "type=DOS16_big", "normal=0x06",
<br>"hidden=0x16" ])
<br>&nbsp;
<h4>
Bibliography</h4>
[1] man lilo.conf
<br>[2] man lilo
</body>
</html>
