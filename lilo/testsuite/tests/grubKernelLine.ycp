/**
 * File:
 *  grubKernelLine.ycp
 *
 * Module:
 *  Bootloader configurator
 *
 * Summary:
 *  Kernel parameters parsing/patching tests.
 *
 * Authors:
 *  Jiri Srain <jsrain@suse.cz>
 *
 * $Id$
 *
 */

{
    include "testsuite.ycp";
    include "lilo/routines.ycp";

    map READ = $["grub": $["sections" : $["linux" : $["kernel" : "(hd0,0)/vmlinuz.suse noval root=/dev/hda3 vga=333"]]]];

    TEST (``(getGrubKernelParamFromLine ("(hd0,0)/vmlinuz.suse noval root=/dev/hda3 vga=333", "root")), [READ, $[], $[]], 0);
    TEST (``(getGrubKernelParamFromLine ("(hd0,0)/vmlinuz.suse noval root=/dev/hda3 vga=333", "vga")), [READ, $[], $[]], 0);
    TEST (``(getGrubKernelParamFromLine ("(hd0,0)/vmlinuz.suse noval root=/dev/hda3 vga=333", "unex")), [READ, $[], $[]], 0);
    TEST (``(getGrubKernelParamFromLine ("(hd0,0)/vmlinuz.suse noval root=/dev/hda3 vga=333", "noval")), [READ, $[], $[]], 0);
    DUMP("==================================================================");
    TEST (``(setGrubKernelParamToLine ("(hd0,0)/vmlinuz.suse noval root=/dev/hda3 vga=333", "root", "/dev/hda5")), [READ, $[], $[]], 0);
    TEST (``(setGrubKernelParamToLine ("(hd0,0)/vmlinuz.suse noval root=/dev/hda3 vga=333", "vga", "55")), [READ, $[], $[]], 0);
    TEST (``(setGrubKernelParamToLine ("(hd0,0)/vmlinuz.suse noval root=/dev/hda3 vga=333", "ide", "nodma")), [READ, $[], $[]], 0);
    TEST (``(setGrubKernelParamToLine ("(hd0,0)/vmlinuz.suse noval root=/dev/hda3 vga=333", "vga", "false")), [READ, $[], $[]], 0);
    TEST (``(setGrubKernelParamToLine ("(hd0,0)/vmlinuz.suse noval root=/dev/hda3 vga=333", "extra", "true")), [READ, $[], $[]], 0);

}

